<!DOCTYPE html>
<html lang="en">
<head>
<title>Pattern Scripts Help</title>
<meta charset="utf-8">
<meta name="AUTHOR" content="Greg Ritacco">
<meta name="PROJECT" content="Pattern scripts for JMRI">
<meta name="VERSION" content="2.0.0">
<style>
  html * {
    font-family: verdana;
  }
  h1 {
    margin-left: 10px;
  }
  h2 {
    margin-left: 10px;
  }
  h3 {
    margin-left: 20px;
  }
  h4 {
    margin-left: 30px;
  }
  p {
    margin-left: 30px;
  }
  img {
    margin-left: 30px;
  }
  pre {
    margin-left: 30px;
  }
</style>
</head>
<body>
<h1>Help Page - Pattern Scripts plugin for JMRI</h1>
<p>The Pattern Scripts plugin for JMRI is a suite of subroutines for JMRI Operations Pro. The use of this plugin is documented in the following list of YouTube videos. The videos are recorded in the English language.</p>
<h3>Pattern Scripts plugin - Video Documentation</h3>
<p><A HREF="https://youtu.be/vFeCn1d2YfI">An overview of this plugin</A></p>
<p><A HREF="https://youtu.be/Sl9yBQaRpeY">How to add this plugin to JMRI</A></p>
<p><A HREF="https://youtu.be/6G7xkRJTczo">How to translate this plugin</A></p>
<p><A HREF="https://youtu.be/GjPtXk3oKmc">How to set up this plugin</A></p>
<p><A HREF="https://youtu.be/DK6O9AQmqXo">How to modify this plugin</A></p>
<h3>Subroutines - Video Documentation</h3>
<p><A HREF="https://youtu.be/rlUfoSesnQo">The o2o subroutine - Use JMRI with TrainPlayerÂ© model railroad software</A></p>
<p>The Patterns subroutine - Overview</p>
<p><A HREF="https://youtu.be/2Tv6sUMDD_Y">The Patterns subroutine - Demonstration at industry</A></p>
<p><A HREF="https://youtu.be/IdXvxyo-E3Y">The Patterns subroutine - Demonstration at a yard</A></p>
<p><A HREF="https://youtu.be/5YleSgJGN9k">The Throwback subroutine - Run what-if scenarios with convenient return-to points</A></p>
<h2>Pattern Scripts plugin</h2>
<h3>Introduction</h3>
<p>The Pattern Scripts plugin can be thought of as a framework for hosting subroutines (or scripts) for JMRI Operations Pro that require a user interface. This plugin comes with four subroutines; jPlus, Patterns, o2o and Throwback. A template is also included to serve as scaffolding for someone wishing to add their own subroutine.</p>
<p>Subroutines may be added or removed individually as needed.</p>
<p>Additionally, each subroutine can be shown or hidden as needed, fron the Tools menu pulldown.</p>
<p>Each of the subroutines' features are only available when the plugin is running and the subroutine has been included. For example, extended railroad details will only appear in reports when the Pattern Scripts plugin has been started, and jPlus has been included. To deactivate the plugins features, close (not hide) the window.</p>
<h3>Organization</h3>
<p>The following chart shows the code structure of this plugin.</P>
<img src="./img/Code_Structure.png" alt="<Code Structure Image>">
<h3>Plugin Layout</h3>
<p>OperationsPatternScripts.MainScript.View.makePatternScriptsWindow()</p>
<img src="./img/Plugin_Layout.png" alt="<Plugin Layout Image>">
<h3>configFile.json</h3>
<p>Each JMRI profile gets its own configuration file, which is named configFile.json. It is found in the operations folder, and is used to provide custom settings for each profile and record user inputs.</p>
<p>Select Tools/Edit Config File. The values that are user editable are in subsections labeled "US" for User Settings. Other values should not be edited. If a mistake is made editing the configFile, the plugin will delete the file and provide a new one to start over using default values. Worst case, the plugin may crash. If that should happed select Tools/Restart From Default.</p>
<h4>User Settings for the Main Script section of configFile.json</h4>
<pre>
  The following are user editable values for the plugin.
  For colors, any of the A, B, G, R values can be changed, between 0 and 255.
  Also, new colors may be added.

  "US" : {
    "OC" : true, <font color="DarkRed">Open Console. Opens the system console when the plugin starts.</font>
    "CD": { <font color="DarkRed">Color Definitions, a set of predefined colors.</font>
        "BLANCH": { <font color="DarkRed">The name of the color.</font>
          "A": 210, <font color="DarkRed">The alpha (transparency) value.</font>
          "B": 255, <font color="DarkRed">The blue component value.</font>
          "D": "Lighten a bit", <font color="DarkRed">A description of the color.</font>
          "G": 255, <font color="DarkRed">The green component value.</font>
          "R": 255 <font color="DarkRed">The red component value.</font>
        },
        "GLOOM": {
          "A": 10,
          "B": 0,
          "D": "Darken a bit",
          "G": 0,
          "R": 0
        },
        "DUST": {
          "A": 255,
          "B": 218,
          "D": "Light tan",
          "G": 242,
          "R": 252
        },
        "FADED": {
          "A": 255,
          "B": 245,
          "D": "Light purple",
          "G": 225,
          "R": 237
        },
        "LICHEN": {
          "A": 255,
          "B": 244,
          "D": "Light green",
          "G": 255,
          "R": 236
        },
        "PALE": {
          "A": 255,
          "B": 250,
          "D": "Light blue",
          "G": 243,
          "R": 237
        },
        "RASH": {
          "A": 255,
          "B": 224,
          "D": "Light red",
          "G": 208,
          "R": 240
        },
        "colorA" : "DUST", <font color="DarkRed">The name of the color to be used when colorA is called.</font>
        "colorB" : "FADED", <font color="DarkRed">The name of the color to be used when colorB is called.</font>
        "colorC" : "RASH" <font color="DarkRed">The name of the color to be used when colorC is called.</font>
      }
    },
</pre>
<!-- Patterns help section html -->
<h2>Patterns Subroutine</h2>
<h3>Description</h3>
<p>The Patterns subroutine can generate pattern reports for tracks at a single location. Additionally, cars can be moved from track to track within a location. Optionally, if a car is moved onto a spur, the schedule for that spur can be applied.</p>
<h3>How to use this subroutine</h3>
<p>If you are using divisions, the Division drop down will display a list of divisions. Selecting a division will load a list of locations for that division into the Location drop down.</p>
<p>With a location selected, a list of check boxes will display, one for each track at the selected location.</p>
<p>The list of tracks can be filtered by clicking the 'Yard Tracks Only' check box on or off.</p>
<p>Individual tracks can be selected by clicking the check box next to the track name.</p>
<p>With tracks selected, pressing the Track Inquiry button will display inventory information (Pattern Report) about the selected tracks. This is printable.</p>
<p>If Tools/Options/Generate CSV Switch List is selected. The Pattern Report will be added to the csvSwitchLists folder as a CSV file.</p>
<p>With tracks selected, pressing the Set Rolling Stock to Track button will pop open one worklist for each track selected.</p>
<p>For each worklist window, a row of buttons, one for each track of the selected location, will display. Pressing one of the track buttons will load the track name into memory.</p>
<p>For any of the rolling stock rows in the Cars At... panel, clicking inside of one of the text boxes will paste the selected track name into the box.</p>
<p>Pressing the + Switch List button will generate a switch list of work for that track. This is printable.</p>
<p>If Tools/Options/Generate CSV Switch List is selected. The switch list will be added to the csvSwitchLists folder as a CSV file.</p>
<p>If o2o is being used, a TrainPlayer work list will also be generated.</p>
<p>Pressing the Set Rolling Stock to Track button will open the Additional Choices pop up.</p>
<p>The pop up adds the option to use a spurs schedule and overide track capacity.</p>
<p>Pressing the Set Cars button will cause the rolling stock in the worklist to be moved to the selected track, subject to type restrictions.</p>
<h3>Subroutine Panel</h3>
<p>Subroutines.Patterns.View.ManageGui</p>
<img src="../Subroutines/Patterns/img/Pattern_Scripts_Subroutine.png" alt="<Pattern Scripts Subroutine Image>">
<h3>Pattern Report for Track Window</h3>
<p>Subroutines.Patterns.ControllerSetCarsForm.CreatePatternReportGui.makeFrame()</p>
<img src="../Subroutines/Patterns/img/Pattern_Report_For_Track.png" alt="<Pattern Report for Track Window Image>">
<h3>Track Pattern, Switch List and Work Event json format</h3>
<p>All the pattern reports start with the creation of a json file. These files are created by this plugin and are written to the jsonManifests folder. They follow the illustrated format:</p>
<img src="../Subroutines/Patterns/img/Report_File_Format.png" alt="<JSON format for reports>">
<p>Depending upon the task, any of the json files will then be written into a Pattern Report or Switchlist text file or exported to TrainPlayer as a WorkEvents csv file.</p>
<h4>User Settings for the Patterns section of configFile.json</h4>
<pre>
  The Patterns section of the configuration file has the following user editable settings.
  
  "US" : {
    "DS" : "Not Assigned", <font color="DarkRed">Destination designator when the field would otherwise be blank.</font>
    "DT" : "Not Scheduled", <font color="DarkRed">Destination Track designator when the field would otherwise be blank.</font>
    "FD" : "Unconsigned", <font color="DarkRed">Final Destination designator when the field would otherwise be blank.</font>
    "FT" : "No Waybill", <font color="DarkRed">Final Destination and Track designator when the field would otherwise be blank.</font>
    "EH" : "Available", <font color="DarkRed">Extended Handling, special case designator for engine, passenger and caboose.</font>
    "SL": [ Sort Locomotives. <font color="DarkRed">Loco lists are sorted on the fields entered here.*</font>
      "Model"
    ],
    "SC": [ Sort Cars. <font color="DarkRed">Car lists are sorted on the fields entered here.*</font>
      "Load_Type",
      "FD&Track"
    ],
    "AW": { <font color="DarkRed">Attribute Width, IE in a report, the Division field is alloted 15 characters.</font>
      " ": 1, 
      "Road": 5, 
      "Number": 7, 
      "Type": 6, 
      "Length": 7, 
      "Color": 6, 
      "Weight": 7,
      "Comment": 15, 
      "Division": 15, 
      "Location": 9, 
      "Track": 6, 
      "Destination": 15, 
      "Owner": 20, 
      "Model": 5, 
      "DCC_Address": 10, 
      "Consist": 8, 
      "Load_Type": 1, 
      "Load": 6, 
      "Hazardous": 10, 
      "Kernel": 7, 
      "Kernel_Size": 3, 
      "Dest&Track": 27, 
      "Final_Dest": 11, 
      "FD&Track": 23, 
      "SetOut_Msg": 12, 
      "PickUp_Msg": 12, 
      "RWE": 10, 
      "RWL": 10, 
      "onTrain": 0, 
      "puso": 6, 
      "setTo": 6
    }
}
<font color="DarkRed">* Note, for Sort Loco "SL" and Sort car "SC", select names from those listed in "AW".</font>
</pre>

</body>
</html>
