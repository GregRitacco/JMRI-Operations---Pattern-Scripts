<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Pattern Scripts Help</title>
<meta charset="utf-8">
<meta name="AUTHOR" content="Greg Ritacco">
<meta name="PROJECT" content="Pattern scripts for JMRI">
<meta name="VERSION" content="2.0.0">
<style>
  html * {
    font-family: verdana;
  }
  h1 {
    margin-left: 10px;
  }
  h2 {
    margin-left: 10px;
  }
  h3 {
    margin-left: 20px;
  }
  h4 {
    margin-left: 30px;
  }
  p {
    margin-left: 30px;
  }
  img {
    margin-left: 30px;
  }
  pre {
    margin-left: 30px;
  }
</style>
</head>

<body>

<h1>Page d'aide - Plugin Pattern Scripts pour JMRI</h1>
<p>Le plugin Pattern Scripts pour JMRI est une suite de sous-programmes pour JMRI Operations Pro. L'utilisation de ce plugin est documentée dans la liste de vidéos suivante.</p>
<h3>Documentation vidéo</h3>
<p>Ces vidéos sont enregistrées en langue anglaise.</p>
<p>Comment ajouter ce plugin à JMRI</p>
<p><A HREF="https://youtu.be/GjPtXk3oKmc">Comment configurer ce plugin</A></p>
<p><A HREF="https://youtu.be/DK6O9AQmqXo">Comment modifier ce plugin</A></p>
<p>Sélectionner les sous-routines</p>
<p><A HREF="https://youtu.be/IdXvxyo-E3Y">Subroutine de traçage - Démonstration sur un chantier</A></p>
<p><A HREF="https://youtu.be/2Tv6sUMDD_Y">Subroutine Track Pattern - Démonstration à l'industrie</A></p>
<p><A HREF="https://youtu.be/rlUfoSesnQo">o2o, la sous-routine ops to ops pour TrainPlayer©</A></p>
<h2>Track Pattern Subroutine</h2>
<h3>Introduction</h3>
<p>La sous-routine Track Pattern permet de générer des rapports de motifs pour les pistes à un seul endroit.
En outre, les voitures peuvent être déplacées d'une piste à l'autre dans un même lieu,
  and optionally, if a car is moved onto a spur, the schedule for that spur can be applied.</p>

<h3>Organisation</h3>
<p>Le tableau suivant montre la structure du code de ce plugin.</P>
<img src="FlowChart1.png" alt="<Flow Chart Image>">

<h3>Plugin Layout</h3>
<p>OperationsPatternScripts.MainScript.View.makePatternScriptsWindow()</p>
<img src="PluginLayout1.png" alt="<Plugin Layout Image>">

<h3>Sous-routine de scripts de modèle</h3>
<p>OperationsPatternScripts.PatternTracksSubroutine.Controller.makeSubroutinePanel()</p>
<img src="PatternScriptsSubroutine1.png" alt="<Pattern Scripts Window Image>">

<h3>Rapport sur les motifs de la fenêtre de suivi</h3>
<p>OperationsPatternScripts.ControllerSetCarsForm.CreatePatternReportGui.makeFrame()</p>
<img src="PatternReportForTrackWindow1.png" alt="<Pattern Report for Track Window Image>">

<h3>Track Pattern and Switch List JSON format</h3>
<p>Les rapports de modèle et les exportations TrainPlayer© commencent tous par la création d'un fichier JSON.
Le fichier est créé par ce plugin et dans le cas des exportations de manifestes TrainPlayer©, le JSON est créé en modifiant le JSON du manifeste généré par JMRI.
Tous les fichiers JSON sont écrits dans le dossier jsonManifests et suivent le format illustré :</p>
<img src="ReportFileFormat1.png" alt="<JSON format for reports>">

<h3>Key – PatternConfig.json</h3>
<p>Chaque profil JMRI obtient son propre fichier de configuration, nommé PatternConfig.json.
Il se trouve dans le dossier des opérations, et est utilisé pour fournir des paramètres personnalisés pour chaque profil et enregistrer les entrées de l'utilisateur.
<br><font color="blue">La description de chaque élément est en bleu</font>
<br><font color="green">Les touches modifiables par l'utilisateur sont décrites en vert.</font>
<br>Des garde-fous ont été mis en place autour des valeurs marquées en vert, mais même ainsi, ce plugin n'est pas en mesure de détecter tous les types d'erreurs.
Si cela se produit, appuyez sur le bouton "Restart from PatternConfig Backup" (redémarrer à partir de la sauvegarde de PatternConfig) et le plugin utilisera le dernier bon fichier PatternConfig.json comme nouveau point de départ.
Dans d'autres cas, si une erreur est commise en modifiant le fichier PatternConfig.json, le plugin le remplacera par le fichier par défaut et l'utilisateur devra recommencer.
<br>Dans le pire des cas, il suffit de supprimer le fichier Pattern Config.json et le plugin en créera un nouveau.</p>

<h4><font color="green">Définitions des couleurs</font></h4>
<pre>
  "CD": {
    "CP": { <font color="blue">Palette de couleurs</font>
      "<font color="green">BLANCH</font>": { <font color="blue">Chacune de ces couleurs peut être modifiée</font>
        "A": <font color="green">255</font>, <font color="blue">Valeur alpha</font>
        "B": <font color="green">225</font>, <font color="blue">Valeur bleue</font>
        "D": <font color="green">Light grey</font>, <font color="blue">Vague description</font>
        "G": <font color="green">225</font>, <font color="blue">Valeur verte</font>
        "R": <font color="green">225</font> <font color="blue">Valeur rouge</font>
      },
      "DUST": {
        "A": 255,
        "B": 218,
        "D": "Light tan",
        "G": 242,
        "R": 252
      },
      "FADED": {
        "A": 255,
        "B": 245,
        "D": "Light purple",
        "G": 225,
        "R": 237
      },
      "LICHEN": {
        "A": 255,
        "B": 244,
        "D": "Light green",
        "G": 255,
        "R": 236
      },
      "PALE": {
        "A": 255,
        "B": 250,
        "D": "Light blue",
        "G": 243,
        "R": 237
      },
      "PETAL": {
        "A": 255,
        "B": 224,
        "D": "Light red",
        "G": 208,
        "R": 240
      }
    },
    "locoColor": <font color="green">"FADED"</font>, <font color="blue">Aucune couleur ne peut être spécifiée avec "".</font>
    "carColor": <font color="green">"DUST"</font>,
    "alertColor": <font color="green">"PETAL"</font>
  },
</pre>
<h4><font color="blue">Panneau de configuration</font></h4>
<pre>
  <font color="blue">Ne pas modifier ces éléments</font>
  "CP" : {
    "TS" : { <font color="blue">Services de traduction</font>
      "UD" : "useDeepL",
      "UX" : "Some Other Translation Service"
    },
    "TC" : "UD", <font color="blue">Translation Choice</font>
    "BT" : ["Plugin", "Help"], <font color="blue">Bundle Targets, nom de base pour chaque bundle</font>
    "AP" : true, <font color="blue">Ajouter un bouton au cadre de Panel Pro, le plugin n'est pas affiché mais toujours activé</font>
    "SE" : "utf-8", <font color="blue">Encodage par défaut</font>
    "SI": [ <font color="blue">Le script comprend</font>
      {
        "PatternTracksSubroutine": true <font color="blue">Inclure cette sous-routine dans le panneau de contrôle</font>
      },
      {
        "o2oSubroutine": false <font color="blue">Inclure cette sous-routine dans le panneau de contrôle</font>
      }
    ],
    "PH" : 220, <font color="blue">Hauteur du panneau par défaut</font>
    "PW" : 1500, <font color="blue">Largeur par défaut du panneau</font>
    "PX" : 0, <font color="blue">Non mis en œuvre</font>
    "PY" : 0, <font color="blue">Non mis en œuvre</font>
    "RV" : 20220205 <font color="blue">Contrôle de la révision</font>
  },
</pre>
<h4><font color="blue">Pattern Tracks</font></h4>
<pre>
  <font color="blue">Ne pas modifier ces éléments</font>
  "PT" : {
    "AL" : [ <font color="blue">Tous les emplacements (écrits par ce plugin)</font>
    ],
    "PL" : "", <font color="blue">Pattern Location (écrit par ce plugin)</font>
    "PT" : { <font color="blue">Pattern-Tracks (écrit par ce plugin)</font>
    },
    "PA" : false, <font color="blue">Drapeau "Yard Tracks Only" (défini par l'utilisateur, écrit par ce plugin)</font>
    "PI" : false, <font color="blue">Ignorer l'indicateur Track Length (défini par l'utilisateur, écrit par ce plugin)</font>
    "AS" : true, <font color="blue">Appliquer le drapeau Schedule (défini par l'utilisateur, écrit par ce plugin)</font>
    "TI" : false, <font color="blue">TrainPlayer Include flag (défini par l'utilisateur, écrit par ce plugin)</font>
    "PW" : 260, <font color="blue">Largeur du motif</font>
    "PH" : 16, <font color="blue">Hauteur du motif</font>
    "RM": 8, <font color="blue">Multiplicateur de rangs</font>
</pre>
<h4><font color="green">Modificateurs de rapport</font></h4>
<pre>
  "RM" : {
    "DS" : "<font color="green">*No Waybill</font>", <font color="blue">Désignation de la destination</font>
    "DT" : "<font color="green">*Not Consigned</font>", <font color="blue">Désignation de la voie de destination</font>
    "FD" : "<font color="green">*Via Staging</font>", <font color="blue">Indicateur de destination finale</font>
    "FT" : "<font color="green">*Any Line</font>", <font color="blue">Destination finale Indicateur de piste</font>
    "SL": [ <font color="blue">Trier les locomotives</font>
      "<font color="green">Model</font>"
    ],
    "SC": [ <font color="blue">Trier les voitures</font>
      "<font color="green">Load Type</font>",
      "<font color="green">FD&Track</font>"
    ],
    "AW": { <font color="blue">La largeur de l'attribut</font>
      "Input": <font color="green">6</font>,
      "Model": <font color="green">5</font>,
      "Road" : <font color="green">5</font>,
      "Number" : <font color="green">7</font>,
      "Type" : <font color="green">6</font>,
      "Length" : <font color="green">7</font>,
      "Weight" : <font color="green">7</font>,
      "Load" : <font color="green">6</font>,
      "Load Type" : <font color="green">5</font>,
      "Loco Type" : <font color="green">18</font>,
      "Owner" : <font color="green">20</font>,
      "Consist" : <font color="green">8</font>,
      "Hazardous" : <font color="green">10</font>,
      "Color" : <font color="green">6</font>,
      "Kernel" : <font color="green">7</font>,
      "Kernel Size" : <font color="green">12</font>,
      "Owner" : <font color="green">6</font>,
      "Track" : <font color="green">6</font>,
      "Location" : <font color="green">9</font>,
      "Destination" : <font color="green">15</font>,
      "Dest&Track" : <font color="green">30</font>,
      "Final Dest" : <font color="green">11</font>,
      "FD&Track" : <font color="green">21</font>,
      "Comment" : <font color="green">15</font>,
      "SetOut Msg" : <font color="green">12</font>,
      "PickUp Msg" : <font color="green">12</font>,
      "RWE" : <font color="green">10</font>,
      " " : 0
    }
  },
</pre>
<h2>o2o Sous-routine, ops 2 ops</h2>
<h3>Introduction</h3>
<p>La sous-routine ops to ops (o2o) est un groupe d'utilitaires conçus pour être la colle qui permet à JMRI Operations Pro d'être le moteur d'opérations de TrainPlayer©.
L'idée est d'étendre les capacités de la fonction Advanced Ops de TrainPlayer© pour y inclure la flexibilité opérationnelle d'Operations Pro,
tout en éliminant l'ennui de maintenir deux bases de données synchronisées.</p>
<h4><font color="green">o2o Subroutine Settings</font></h4>
<pre>
  "o2o" : {
    "PC": [  <font color="blue">Liste des codes de wagons TrainPlayer pour les voitures particulières.</font>
      "B",
      "BE",
      "BH",
      "BM",
      "BMR",
      "BMT",
      "BP",
      "BR",
      "BX",
      "CA",
      "CS",
      "D",
      "DA",
      "DB",
      "DC",
      "DL",
      "DO",
      "DP",
      "DPA",
      "MA",
      "MB",
      "MR",
      "P",
      "PA",
      "PAS",
      "PB",
      "PBC",
      "PBO",
      "PC",
      "PL",
      "PO",
      "PS",
      "PSA"
    ],
    "CC" : [  <font color="blue">Liste des codes des wagons de queue de TrainPlayer.</font>
      "N",
      "NM",
      "NE"
    ],
    "CFL" : [  <font color="blue">Core File List</font>
      "OperationsCarRoster",
      "OperationsEngineRoster",
      "OperationsLocationRoster"
    ],
    "SM" : {  <font color="blue">Scale Matrix </font>JMRI Échelle de chemin de fer miniature.
      "Z" : 1,
      "N" : 2,
      "TT" : 3,
      "HOn3" : 4,
      "OO" : 5,
      "HO" : 6,
      "Sn3" : 7,
      "S" : 8,
      "On3" : 9,
      "O" : 10,
      "G" : 11
    },
    "SME" : <font color="green">true</font>,  setMainMenuEnabled
    "CWS" : <font color="green">true</font>,  setCloseWindowOnSaveEnabled
    "SBA" : <font color="green">true</font>,  setBuildAggressive
    "SIA" : <font color="green">true</font>,  setStagingTrackImmediatelyAvail
    "SCT" : <font color="green">"ARR Codes"</font>,  setCarTypes
    "SCL" : <font color="green">true</font>,  setAddCustomLoadsAnySpurEnabled
    "RCL" : <font color="green">true</font>,  setRemoveCustomLoadsEnabled
    "LEE" : <font color="green">true</font>,  setLoadEmptyEnabled
    "TR" : {  <font color="blue">Type Rubric</font> Align TrainPlayer to JMRI track types.
      "industry": "Spur",
      "interchange": "Interchange",
      "staging": "Staging",
      "class yard": "Yard"
    }

</pre>
</body>

</html>
