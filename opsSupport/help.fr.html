<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Pattern Scripts Help</title>
<meta charset="utf-8">
<meta name="AUTHOR" content="Greg Ritacco">
<meta name="PROJECT" content="Pattern scripts for JMRI">
<meta name="VERSION" content="2.0.0">
<style>
  html * {
    font-family: verdana;
  }
  h1 {
    margin-left: 10px;
  }
  h2 {
    margin-left: 10px;
  }
  h3 {
    margin-left: 20px;
  }
  h4 {
    margin-left: 30px;
  }
  p {
    margin-left: 30px;
  }
  img {
    margin-left: 30px;
  }
  pre {
    margin-left: 30px;
  }
</style>
</head>

<body>

<h1>Page d'aide - Plugin Pattern Scripts pour JMRI</h1>
<p>Le plugin Pattern Scripts pour JMRI est une suite de sous-programmes pour JMRI Operations Pro.
L'utilisation de ce plugin est documentée dans la liste suivante de vidéos.
The videos are recorded in the English language.</p>

<h3>Plugin Scripts de motifs - Documentation vidéo</h3>

<p>Visualisation de ce plugin</p>
<p><A HREF="https://youtu.be/Sl9yBQaRpeY">Comment ajouter ce plugin à JMRI</A></p>
<p><A HREF="https://youtu.be/6G7xkRJTczo">Comment traduire ce plugin</A></p>
<p><A HREF="https://youtu.be/GjPtXk3oKmc">Comment configurer ce plugin</A></p>
<p><A HREF="https://youtu.be/DK6O9AQmqXo">Comment modifier ce plugin</A></p>
<h3>Sous-routines - Documentation vidéo</h3>
<p>Le sous-programme j plus</A></p>
<p><A HREF="https://youtu.be/IdXvxyo-E3Y">Subroutine de modèle de piste - Démonstration sur un chantier</A></p>
<p><A HREF="https://youtu.be/2Tv6sUMDD_Y">Subroutine Track Pattern - Démonstration à l'industrie</A></p>
<p><A HREF="https://youtu.be/rlUfoSesnQo">o2o, la sous-routine ops to ops pour TrainPlayer©</A></p>

<h2>Plugin Scripts de motifs</h2>
<h3>Introduction</h3>
<p>Le plugin Pattern Scripts peut être considéré comme un cadre permettant d'héberger des sous-programmes pour JMRI Operations Pro qui nécessitent une interface utilisateur.
Ce plugin est livré avec trois sous-programmes : j Plus, Pattern Tracks et o2o.
Un modèle est également inclus pour servir d'échafaudage à une personne souhaitant ajouter son propre sous-programme.
Bien que les sous-routines soient quelque peu interdépendantes, elles peuvent être activées ou désactivées individuellement selon les besoins.</p>

<h3>Organisation</h3>
<p>Le tableau suivant montre la structure du code de ce plugin.</P>
<img src="Code_Structure.png" alt="<Code Structure Image>">

<h3>Plugin Layout</h3>
<p>OperationsPatternScripts.MainScript.View.makePatternScriptsWindow()</p>
<img src="Plugin_Layout.png" alt="<Plugin Layout Image>">

<h3>PatternConfig.json</h3>
<p>Chaque profil JMRI obtient son propre fichier de configuration, nommé PatternConfig.json.
Il se trouve dans le dossier des opérations, et est utilisé pour fournir des paramètres personnalisés pour chaque profil et enregistrer les entrées de l'utilisateur.
<br><font color="blue">La description de chaque élément est en bleu</font>
<br><font color="green">Les touches modifiables par l'utilisateur sont décrites en vert.</font>
<br>Select Tools/Edit Config File.
If a mistake is made editing the PatternConfig.json file, the plugin will delete the file and provide a new one to start over with.
Worst case the plugin may crash. If </p>

<h4>Les paramètres du plugin Pattern Scripts dans PatternConfig.json</h4>
<pre>
  "CP" : { <font color="blue">Panneau de configuration</font>
    "TS" : { <font color="blue">Services de traduction</font>
      "UD" : "UseDeepL",
      "UX" : "UseSomethingElse"
    },
    "TC" : "UD", <font color="blue">Choix de la traduction</font>
    "LN" : "", <font color="blue">Nom de la mise en page à partir des paramètres JMRI</font>
    "DR" : true, <font color="blue">Réservé</font>
    "AP" : true, <font color="blue">Ajouter un bouton au cadre de Panel Pro, le plugin n'est pas affiché mais toujours activé</font>
    "SE" : "utf-8", <font color="blue">Encodage par défaut</font>
    "IL" : [ <font color="blue">Liste d'inclusion, les sous-routines sont incluses dans cet ordre</font>
      "jPlusSubroutine",
      "PatternTracksSubroutine",
      "o2oSubroutine"
    ],
    "jPlusSubroutine" : false, <font color="blue">Statut d'activation</font>
    "PatternTracksSubroutine" : true, <font color="blue">Statut d'activation</font>
    "o2oSubroutine" : false, <font color="blue">Statut d'activation</font>
    "PH" : 280, <font color="blue">Hauteur du panneau par défaut</font>
    "PW" : 1100, <font color="blue">Largeur par défaut du panneau</font>
    "PX" : 0, <font color="blue">Emplacement du plugin, axe X</font>
    "PY" : 0, <font color="blue">Emplacement du plugin, axe Y</font>
    "OC" : true, <font color="green">Ouvrir la fenêtre de la console système au démarrage du plugin</font>
    "RV" : 20221122 <font color="blue">Contrôle de la révision</font>
  },
  "CD": { <font color="blue">Définitions des couleurs</font>
    "CP": { <font color="blue">Palette de couleurs</font>
      "<font color="green">BLANCH</font>": { <font color="blue">Chacune de ces couleurs peut être modifiée</font>
        "A": <font color="green">255</font>, <font color="blue">Valeur alpha</font>
        "B": <font color="green">225</font>, <font color="blue">Valeur bleue</font>
        "D": <font color="green">Light grey</font>, <font color="blue">Description vague</font>
        "G": <font color="green">225</font>, <font color="blue">Valeur verte</font>
        "R": <font color="green">225</font> <font color="blue">Valeur rouge</font>
      },
      "DUST": {
        "A": 255,
        "B": 218,
        "D": "Light tan",
        "G": 242,
        "R": 252
      },
      "FADED": {
        "A": 255,
        "B": 245,
        "D": "Light purple",
        "G": 225,
        "R": 237
      },
      "LICHEN": {
        "A": 255,
        "B": 244,
        "D": "Light green",
        "G": 255,
        "R": 236
      },
      "PALE": {
        "A": 255,
        "B": 250,
        "D": "Light blue",
        "G": 243,
        "R": 237
      },
      "PETAL": {
        "A": 255,
        "B": 224,
        "D": "Light red",
        "G": 208,
        "R": 240
      },
    "locoColor": <font color="green">"FADED"</font> Ne spécifiez aucune couleur avec ""
    "carColor": <font color="green">"DUST"</font>,
    "alertColor": <font color="green">"PETAL"</font>
  },
  "TO" : { <font color="blue">Opérations de la semaine, ajustements des paramètres des opérations</font>
    "SME" : <font color="green">true</font>,  setMainMenuEnabled
    "CWS" : <font color="green">true</font>,  setCloseWindowOnSaveEnabled
    "SBA" : <font color="green">true</font>,  setBuildAggressive
    "SIA" : <font color="green">true</font>,  setStagingTrackImmediatelyAvail
    "SCT" : <font color="green">"ARR Codes"</font>,  setCarTypes
    "TNB" : <font color="green">true</font>,  setStagingTryNormalBuildEnabled
    "SME" : <font color="green">true</font>,  setManifestEditorEnabled
    "PUC" : <font color="green">"Road", "Number", "Type", "Load Type", "Load", "Destination"</font>,  setPickupManifestMessageFormat
    "SOC" : <font color="green">"Road", "Number", "Type", "Load Type", "Load", "Destination"</font>,  setDropManifestMessageFormat
    "MC" : <font color="green">"Road", "Number", "Type", "Load Type", "Load", "Final Dest"</font>,  setLocalManifestMessageFormat
    "PUL" : <font color="green">"Road", "Number", "Model", "Consist", "Destination"</font>,  setPickupEngineMessageFormat
    "SOL" : <font color="green">"Road", "Number", "Model", "Consist", "Destination"</font>,  setDropEngineMessageFormat
    },
  "SM" : { <font color="blue">Staging modifiers</font>
    "SCL" : <font color="green">true</font>,  setAddCustomLoadsAnySpurEnabled
    "RCL" : <font color="green">true</font>,  setRemoveCustomLoadsEnabled
    "LEE" : <font color="green">true</font>,  setLoadEmptyEnabled
  },
</pre>

<h2>j Plus Subroutine</h2>
<h3>Introduction</h3>
<p>Le sous-programme j Plus ajoute des détails ferroviaires améliorés aux rapports générés par JMRI et ce plugin.</P>
<p>Les données de cette sous-routine sont saisies dans les zones de texte ou, si la sous-routine TrainPlayer est activée, les détails supplémentaires sur les chemins de fer sont importés à partir du modèle TrainPlayer.</P>
<p>Il n'est pas nécessaire de remplir tous les champs.</P>
<p>Les champs améliorés sont les suivants :</P>
<h4>Nom du chemin de fer en activité</h4>
<p>Il s'agit du chemin de fer qui possède ou exploite les voies modélisées. N'importe quel nom peut être saisi, tel que 'PRR' ou 'BN UPRR Joint' ou 'G&D'.</P>
<h4>Territoire opérationnel</h4>
<p>Il s'agit du nom du chemin de fer pour la partie modélisée, par exemple "Long Beach Intermodal Terminal" ou "Salem Glass Works Branch".</P>
<h4>Localisation</h4>
<p>L'endroit où se trouve le chemin de fer, par exemple "The Great Divide" ou "The Bronx, New York".</P>
<h4>Année modélisée</h4>
<p>L'année sur laquelle le modèle ferroviaire est basé, c'est un miroir de 'JMRI/OperationsPro/Settings/Year Modeled'.</p>

<h3>Subroutine Panel</h3>
<p>OperationsPatternScripts.jPlusSubroutine.Controller.makeSubroutinePanel()</p>
<img src="j_Plus_Subroutine.png" alt="<j Plus Subroutine Image>">

<h4>j Plus Paramètres des sous-routines dans PatternConfig.json</h4>
<pre>
  "JP" :{  <font color="blue">j Plus Details.</font>
    "OR" : "", <font color="green">Chemin de fer opérationnel, celui qui possède les voies.</font>
    "TR" : "", <font color="green">Nom de l'opération particulière qui est modélisée.</font>
    "LO" : "", <font color="green">L'emplacement du prototype.</font>
    "YR" : "", <font color="green">Année civile faisant l'objet du modèle.</font>
    "SC" : "", <font color="green">Échelle de modélisme ferroviaire, à partir des paramètres ou de TrainPlayer.</font>
    "LN" : "", <font color="green">Nom de la maquette, à partir des paramètres ou de TrainPlayer.</font>
    "BD" : "", <font color="blue">Date de construction de TrainPlayer.</font>
  },
</pre>

<h2>Track Pattern Subroutine</h2>
<h3>Introduction</h3>
<p>La sous-routine Track Pattern permet de générer des rapports de motifs pour les pistes à un seul endroit.
  En outre, les voitures peuvent être déplacées d'une piste à l'autre dans un même lieu.
  En option, si une voiture est déplacée sur un embranchement, l'horaire de cet embranchement peut être appliqué.</p>

<h3>Subroutine Panel</h3>
<p>OperationsPatternScripts.PatternTracksSubroutine.Controller.makeSubroutinePanel()</p>
<img src="Pattern_Scripts_Subroutine.png" alt="<Pattern Scripts Subroutine Image>">

<h3>Rapport sur les modèles de la fenêtre de suivi</h3>
<p>OperationsPatternScripts.ControllerSetCarsForm.CreatePatternReportGui.makeFrame()</p>
<img src="Pattern_Report_For_Track.png" alt="<Pattern Report for Track Window Image>">

<h3>Track Pattern et Switch List en format JSON</h3>
<p>Les rapports de modèle et les exportations TrainPlayer© commencent tous par la création d'un fichier JSON.
Le fichier est créé par ce plugin et dans le cas des exportations de manifestes TrainPlayer©, le JSON est créé en modifiant le JSON du manifeste généré par JMRI.
Tous les fichiers JSON sont écrits dans le dossier jsonManifests et suivent le format illustré :</p>
<img src="Report_File_Format.png" alt="<JSON format for reports>">

<h4>Suivre les paramètres des sous-programmes de motifs dans PatternConfig.json</h4>
<pre>
  "PT" : { <font color="blue">Pattern Tracks</font>
    "AD" : [ <font color="blue">Toutes les divisions (écrites par ce plugin)</font>
    ],
    "AL" : [ <font color="blue">Tous les emplacements (écrits par ce plugin)</font>
    ],
    "PL" : "", <font color="blue">Pattern Location (écrit par ce plugin)</font>
    "PT" : { <font color="blue">Pattern-Tracks (écrit par ce plugin)</font>
    },
    "PA" : false, <font color="blue">drapeau "Yard Tracks Only" (défini par l'utilisateur, écrit par ce plugin)</font>
    "PI" : false, <font color="blue">Ignorer l'indicateur Track Length (défini par l'utilisateur, écrit par ce plugin)</font>
    "AS" : true, <font color="blue">Appliquer le drapeau Schedule (défini par l'utilisateur, écrit par ce plugin)</font>
    "TI" : false, <font color="blue">TrainPlayer Include flag (défini par l'utilisateur, écrit par ce plugin)</font>
    "PW" : 260, <font color="blue">Largeur du motif</font>
    "PH" : 16, <font color="blue">Hauteur du motif</font>
    "RM": 8, <font color="blue">Multiplicateur de rangs</font>

  "RM" : { <font color="blue">Modificateurs de rapport</font></h4>
    "DS" : "<font color="green">*No Waybill</font>", <font color="blue">Désignation de la destination</font>
    "DT" : "<font color="green">*Not Consigned</font>", <font color="blue">Désignation de la voie de destination</font>
    "FD" : "<font color="green">*Via Staging</font>", <font color="blue">Indicateur de destination finale</font>
    "FT" : "<font color="green">*Any Line</font>", <font color="blue">Destination finale Indicateur de piste</font>
    "SL": [ <font color="blue">Trier les locomotives</font>
      "<font color="green">Model</font>"
    ],
    "SC": [ <font color="blue">Trier les voitures</font>
      "<font color="green">Load Type</font>",
      "<font color="green">FD&Track</font>"
    ],
    "AW": { <font color="blue">La largeur de l'attribut</font>
      "Input": <font color="green">6</font>,
      "Model": <font color="green">5</font>,
      "Road" : <font color="green">5</font>,
      "Number" : <font color="green">7</font>,
      "Type" : <font color="green">6</font>,
      "Length" : <font color="green">7</font>,
      "Weight" : <font color="green">7</font>,
      "Load" : <font color="green">6</font>,
      "Load Type" : <font color="green">5</font>,
      "Loco Type" : <font color="green">18</font>,
      "Owner" : <font color="green">20</font>,
      "Consist" : <font color="green">8</font>,
      "Hazardous" : <font color="green">10</font>,
      "Color" : <font color="green">6</font>,
      "Kernel" : <font color="green">7</font>,
      "Kernel Size" : <font color="green">12</font>,
      "Owner" : <font color="green">6</font>,
      "Track" : <font color="green">6</font>,
      "Location" : <font color="green">9</font>,
      "Destination" : <font color="green">15</font>,
      "Dest&Track" : <font color="green">30</font>,
      "Final Dest" : <font color="green">11</font>,
      "FD&Track" : <font color="green">21</font>,
      "Comment" : <font color="green">15</font>,
      "SetOut Msg" : <font color="green">12</font>,
      "PickUp Msg" : <font color="green">12</font>,
      "RWE" : <font color="green">10</font>,
      " " : 0
    }
  },
</pre>
<h2>o2o Sous-routine, ops 2 ops</h2>
<h3>Introduction</h3>
<p>La sous-routine ops to ops (o2o) est un groupe d'utilitaires conçus pour être la colle qui permet à JMRI Operations Pro d'être le moteur d'opérations de TrainPlayer©.
L'idée est d'étendre les capacités de la fonction Advanced Ops de TrainPlayer© pour y inclure la flexibilité d'Operations Pro,
tout en éliminant l'ennui de maintenir deux bases de données synchronisées.</p>

<h3>Qui fait quoi</h3>
<p>Le tableau ci-dessous indique quel programme gère quels éléments.</p>
<img src="Who_Does_What.png" alt="<Who Does What Image>">

<h3>Subroutine Panel</h3>
<p>OperationsPatternScripts.PatternTracksSubroutine.Controller.makeSubroutinePanel()</p>
<img src="o2o_Subroutine.png" alt="<o2o Subroutine Image>">

<h4>o2o Paramètres des sous-routines dans PatternConfig.json</h4>
<pre>
  "RD" :{  <font color="blue">Détails ferroviaires, partie facultative de la mise en page TrainPlayer.</font>
    "RR" : "", <font color="blue">Parent chemin de fer, celui qui possède les voies.</font>
    "OP" : "", <font color="blue">Name of the particular operation being modeled.</font>
    "LO" : "", <font color="blue">L'emplacement du prototype.</font>
    "YR" : "", <font color="blue">Année civile faisant l'objet du modèle.</font>
    "DV" : [], <font color="blue">Liste des divisions ferroviaires pour ce réseau, séparées par des virgules.</font>
    "SC" : "" <font color="blue">Échelle de modélisme ferroviaire.</font>
  },
  "o2o" : {
    "PC": [  <font color="blue">Liste des codes de wagons TrainPlayer pour les voitures particulières.</font>
      "B",
      "BE",
      "BH",
      "BM",
      "BMR",
      "BMT",
      "BP",
      "BR",
      "BX",
      "CA",
      "CS",
      "D",
      "DA",
      "DB",
      "DC",
      "DL",
      "DO",
      "DP",
      "DPA",
      "MA",
      "MB",
      "MR",
      "P",
      "PA",
      "PAS",
      "PB",
      "PBC",
      "PBO",
      "PC",
      "PL",
      "PO",
      "PS",
      "PSA"
    ],
    "CC" : [  <font color="blue">Liste des codes des wagons de queue de TrainPlayer.</font>
      "N",
      "NM",
      "NE"
    ],
    "CFL" : [  <font color="blue">Core File List</font>
      "OperationsCarRoster",
      "OperationsEngineRoster",
      "OperationsLocationRoster"
    ],
    "SR" : {  <font color="blue">Scale Rubric</font> JMRI Model Railroad scale.
      "Z" : 1,
      "N" : 2,
      "TT" : 3,
      "HOn3" : 4,
      "OO" : 5,
      "HO" : 6,
      "Sn3" : 7,
      "S" : 8,
      "On3" : 9,
      "O" : 10,
      "G" : 11
    },
    "RF" : { <font color="blue">Report Files</font> Noms des fichiers d'exportation de la mise en page de TrainPlayer.
      "TRL" : <font color="blue">"TrainPlayer Report - Locations.txt"</font>,
      "TRI" : <font color="blue">"TrainPlayer Report - Industries.txt"</font>,
      "TRR" : <font color="blue">"TrainPlayer Report - Rolling Stock.txt"</font>
    },

    "TR" : {  <font color="blue">Type Rubric</font> Aligner les types de voies du TrainPlayer et du JMRI.
      "industry": "Spur",
      "interchange": "Interchange",
      "staging": "Staging",
      "class yard": "Yard",
      "XO reserved": "Spur"
    }
</pre>

</body>

</html>
